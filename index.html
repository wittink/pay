<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>송금 안내</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 flex items-center justify-center min-h-screen p-4">

    <div class="w-full max-w-sm mx-auto bg-white rounded-3xl shadow-2xl p-8 text-center">
        <h2 class="text-xl font-bold mb-6 text-gray-800">계좌 정보를 확인해주세요</h2>
        
        <div class="bg-blue-50 border-2 border-blue-200 rounded-2xl p-6 mb-8">
            <div id="displayBank" class="text-blue-600 font-bold text-lg">은행</div>
            <div id="displayAcc" class="text-2xl font-mono font-bold my-2 text-gray-900 tracking-tighter">000-000-0000</div>
            <div id="displayName" class="text-sm font-medium text-gray-500">예금주</div>
        </div>
        
        <button onclick="openSystemChooser()" 
            class="w-full py-4 bg-blue-600 text-white rounded-2xl font-bold text-lg shadow-lg active:scale-95 transition-all">
            계좌번호 복사 및 은행 앱 열기
        </button>

        <p class="mt-4 text-[11px] text-gray-400 leading-tight">
            버튼을 누르면 하단에 설치된 은행 앱 목록이 나타납니다.<br>
            (안드로이드 전용 기능)
        </p>
    </div>

    <script>
        // 1. 데이터 로드 (URL 파라미터 방식)
        const params = new URLSearchParams(window.location.search);
        const acc = params.get('acc') || '000-000-0000';
        document.getElementById('displayBank').innerText = params.get('bank') || '은행 정보';
        document.getElementById('displayAcc').innerText = acc;
        document.getElementById('displayName').innerText = `예금주: ${params.get('name') || '미지정'}`;

        // 2. 핵심 함수: 안드로이드 시스템 앱 선택기 호출
        function openSystemChooser() {
            // 계좌번호 텍스트를 안전하게 인코딩
            const text = encodeURIComponent(acc);

            // 안드로이드 시스템에 "이 텍스트를 처리할 수 있는 앱을 모두 나열해"라고 명령하는 표준 Intent
            const intent = [
                `intent://send?text=${text}#Intent`,
                `action=android.intent.action.SEND`,
                `type=text/plain`,
                `end`
            ].join(';');

            const ua = navigator.userAgent.toLowerCase();
            if (ua.includes('android')) {
                // 안드로이드에서 시스템 앱 목록 팝업 실행
                location.href = intent;
            } else {
                // 아이폰 등 기타 환경에서는 텍스트 복사만 수행
                const el = document.createElement('textarea');
                el.value = acc;
                document.body.appendChild(el);
                el.select();
                document.execCommand('copy');
                document.body.removeChild(el);
                alert("계좌번호가 복사되었습니다.\n은행 앱을 열어 붙여넣어 주세요.");
            }
        }
    </script>
</body>
</html>
